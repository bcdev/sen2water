Sen2Water README
================
2024-01-09 0.1
2024-01-25 0.2
2024-07-19 0.4

This is the prototype of the Sen2Water processor distributed to partners
of the OPT-MPC Sen2Water project for validation. This version and its
configuration has been aligned with the expected future configurations
of the CGLOPS inland water service and the CMS coastal water service.

Compared to the services Sen2Water uses a more advanced version of
POLYMER and a more advanced configuration of it. Sen2Water uses a more
advanced version of ACOLITE and a more advanced configuration as well.
Sen2Water uses the same version of C2RCC and the Copernicus 90m DEM
instead of GETASSE30.

It is not the final form of delivery and includes among others ACOLITE
and POLYMER that come with conditions for their distribution that may
require a different form of installation by end users.

The prototype comprises

sen2water-0.4/
    bin/
        mys2w          environment source script
        sen2water.sh   processor control script
    lib/
        idepix/        Idepix processor
        c2rcc/         C2RCC processor
        acolite/       ACOLITE processor
        polymer/       POLYMER processor
        msiresampling/ processor for Sen2Water combination of AC results
        snap/          SNAP runtime
        jre/           JAVA runtime
        conda/         PYTHON runtime
    etc/               templates
    auxdata/           processor auxiliary data, tiles of Copernicus DEM
    licenses/
    README

Instructions
------------

Install this package and the corresponding auxiliary package on a
Linux machine in the same folder.

cd /some/software/folder/
tar xf sen2water-0.4-20240719.tar.gz
tar xf sen2water-auxdata-0.4.tar.gz

If the Copernicus 90m DEM tile for an input granule is not yet
installed in the sen2water-0.4/auxdata/dem/ folder it will be
automatically downloaded. For this purpose the auxdata folder must be
writeable by the user executing the processor.

To avoid automated download of the DEM a directory with the Copernicus
DEM can be provided. It needs to be linked into sen2water-0.4/auxdata
with the correct name:

rm -r sen2water-0.4/auxdata/dem/'Copernicus 90m Global DEM'
ln -s /path/to/Copernicus90mGlobalDEM sen2water-0.2/auxdata/dem/'Copernicus 90m Global DEM'
#rm -r sen2water-0.4/auxdata/'Copernicus 30m Global DEM'
#ln -s /path/to/Copernicus30mGlobalDEM sen2water-0.2/auxdata/dem/'Copernicus 30m Global DEM'

Create a working directory on a partition with space for input,
intermediates, and output. Extract an input into this working
directory.

mkdir wd
cd wd
unzip S2A_MSIL1C_20240104T103431_N0510_R108_T32UME_20240104T123149.zip

Set the shell environment and start the processor.

. ../sen2water-0.2/bin/mys2w
sen2water.sh S2A_MSIL1C_20240104T103431_N0510_R108_T32UME_20240104T123149.SAFE

The processor will run for about 10 minutes and generate an output file
S2A_MSIL2W_20240104T103431_N0510_R108_T32UME_20240104T123149.nc . This
file can be inspected with the Sentinel Toolbox.
